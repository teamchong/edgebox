// EdgeBox Crypto Interface
// WASI Component Model interface for cryptographic operations
//
// NOTE: hash() and hmac() removed - now handled by sandbox native polyfills
// (src/polyfills/crypto.zig) for zero host crossing performance.
// Component Model only exposes genuine host functions (CSPRNG).

package edgebox:runtime@1.0.0;

// Crypto error types
enum crypto-error {
  operation-failed,
  invalid-input,
}

interface crypto {
  /// Generate cryptographically secure random bytes (CSPRNG)
  /// This is the ONLY crypto function that needs host access.
  /// All other crypto (hash, hmac, aes-gcm) runs in sandbox via native polyfills.
  ///
  /// size: Number of random bytes to generate
  /// Returns: List of cryptographically secure random bytes or error
  random-bytes: func(size: u32) -> result<list<u8>, crypto-error>;
}
